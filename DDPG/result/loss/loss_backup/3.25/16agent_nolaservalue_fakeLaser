from collections import defaultdict
from tqdm import tqdm
import numpy as np
import sys
import time
import rospy
import pickle
import copy

from gazebo_drl_env.srv import SimpleCtrl
from gazebo_drl_env.msg import control_group_msgs
from gazebo_drl_env.msg import state_group_msgs
from gazebo_drl_env.msg import control_msgs
from gazebo_drl_env.msg import state_msgs

from cv_bridge import CvBridge

# remove the ros packages path, or cv2 can not work
#sys.path.remove('/opt/ros/kinetic/lib/python2.7/dist-packages') 
import cv2

from HNRN import HNRN
import utils

## ------------------------------

# 1 - train target driven actor, I think it is useless now.
# 2 - train collision avoidance actor
# 3 - differential driver
TRAIN_TYPE = 2

MAX_OPTIMIZATION_STEP = 30
TIME_DELAY = 2#5
STATE_DIM = 2
SENSOR_DIM = 360
ACTION_DIM = 2
MAX_EPISODES = 5000
MAX_STEPS = 120#30
MAX_BUFFER = 5000000 #50000
HER_K = 8
TARGET_THRESHOLD = 0.01
TEST_ROUND = 20
TEST_EPISODE = 20 if TRAIN_TYPE == 1 else 40
AGENT_NUMBER = 16
OBSERVATION_RANGE = 2
MIN_EXPERIMENCE_NUMBER = 3

USE_HER = False
USE_DIR = False
USE_TEST = True
USE_SHAPED_REWARD = False
USE_LASER_REWARD = False#True
USE_SURVIVE_REWARD = False

CONTINUE_TRAIN = False

# use absolute coordinate to generate
GENERATE_LASER_FORM_POS = True
ROBOT_LENGTH = 0.25
LASER_RANGE = 3.5

## ------------------------------

# noise parameters
mu = 0 
theta = 2
sigma = 0.2

# learning rate
actor_lr = 1e-4
critic_lr = 1e-3
batch_size = 256

# update parameters
gamma = 0.99
tau = 0.001
hmm_state = 10

